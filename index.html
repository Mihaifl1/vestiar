<!doctype html>
<html lang="ro">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Vestiar – poziții din cod + coordonate mouse</title>
<style>
  :root{
    --bg:#0b1220; --wall:#e5e7eb;
    --closed:#22c55e;  /* verde = ÎNCHIS  */
    --open:#ef4444;    /* roșu  = DESCHIS */
    --nopower:#6b7280; --hinge:#94a3b8;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:#fff;font-family:Arial,Helvetica,sans-serif}
  .wrap{max-width:1100px;margin:0 auto;padding:16px}
  h1{font-size:20px;margin:0 0 10px}

  .legend{font-size:14px;opacity:.9;margin:8px 0 12px}
  .legend span{display:inline-block;margin-right:8px;padding:2px 8px;border-radius:6px}
  .legend .c{background:var(--closed)}
  .legend .o{background:var(--open)}
  .legend .p{background:var(--nopower)}

  /* Canvas-ul planului: imagine integrală + overlay absolut */
  .plan{
    position:relative; width:100%;
    border:10px solid var(--wall); border-radius:12px; overflow:hidden;
    background:#0b1220;
    user-select:none;
  }
  .plan-img{
    display:block; width:100%; height:auto; /* imaginea e integrală, scalată proporțional */
  }
  .overlay{
    position:absolute; inset:0; pointer-events:auto; /* stratul de deasupra imaginii */
  }

  /* HUD coordonate */
  .hud{
    position:absolute; right:10px; top:10px; z-index:10;
    background:rgba(15,23,42,.9); border:1px solid #334155; border-radius:8px;
    padding:6px 10px; font-size:12px; white-space:nowrap
  }
  .hud code{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace}

  /* Ușile – doar vizual (nu se pot trage) */
  .door{
    position:absolute; left:0; top:0;
    --x: 0%; --y: 0%; --a: 0;           /* variabile setate din JS conform CONFIG */
    transform: translate(var(--x), var(--y)) rotate(calc(var(--a) * 1deg));
    transform-origin: 0 0;
    width: 84px; height: 44px;
    cursor:pointer;
  }
  .door .hinge{
    position:absolute; top:12px; width:8px; height:20px;
    background:var(--hinge); border-radius:4px;
  }
  .door .leaf{
    position:absolute; top:8px; width:72px; height:28px;
    border:2px solid #000; border-radius:6px; background:var(--closed);
    transition: transform .25s ease, background .2s ease, box-shadow .2s ease;
    transform-origin: left center; box-shadow:0 0 0 rgba(0,0,0,0);
  }
  .door .label{
    position:absolute; left:0; top:-14px; font-size:12px; font-weight:bold;
    text-shadow:0 1px 2px rgba(0,0,0,.5)
  }

  /* Balamaua controlează poziția elementelor în grup */
  .door[data-hinge="left"] .hinge{ left:-6px }
  .door[data-hinge="right"] .hinge{ right:-6px }
  .door[data-hinge="left"]  .leaf{ left:0;  transform-origin:left  center }
  .door[data-hinge="right"] .leaf{ right:0; transform-origin:right center }

  /* DESCHIS = rotație în afară față de balama */
  .door[data-hinge="left"].open  .leaf{ transform: rotate(92deg);  background:var(--open);  box-shadow:0 6px 10px rgba(0,0,0,.45) }
  .door[data-hinge="right"].open .leaf{ transform: rotate(-92deg); background:var(--open);  box-shadow:0 6px 10px rgba(0,0,0,.45) }
  .door.nopower .leaf{ background:var(--nopower) }
</style>
</head>
<body>
<div class="wrap">
  <h1>Vestiar – poziții din cod (imagine integrală) + coordonate mouse</h1>
  <div class="legend">
    <span class="c">ÎNCHIS (verde)</span>
    <span class="o">DESCHIS (roșu)</span>
    <span class="p">Fără alimentare (gri)</span>
    <span style="opacity:.8;margin-left:8px">Click pe ușă = comută, Shift+Click = fără alimentare</span>
  </div>

  <div class="plan" id="plan">
    <!-- Imagine integrală (NU se taie) -->
    <img id="planImg" class="plan-img" src="vestiar.jpg" alt="Plan Vestiar">

    <!-- HUD coordonate -->
    <div class="hud" id="hud">X: <code>0%</code> &nbsp; Y: <code>0%</code> &nbsp; <span id="px">(0×0 px)</span></div>

    <!-- Overlay pt. uși -->
    <div class="overlay" id="overlay">
      <div class="door" id="d1" data-hinge="left"><div class="hinge"></div><div class="leaf"></div><div class="label">Ușa 1</div></div>
      <div class="door" id="d2" data-hinge="left"><div class="hinge"></div><div class="leaf"></div><div class="label">Ușa 2</div></div>
      <div class="door" id="d3" data-hinge="left"><div class="hinge"></div><div class="leaf"></div><div class="label">Ușa 3</div></div>
      <div class="door" id="d4" data-hinge="right"><div class="hinge"></div><div class="leaf"></div><div class="label">Ușa 4</div></div>
      <div class="door" id="d5" data-hinge="right"><div class="hinge"></div><div class="leaf"></div><div class="label">Ușa 5</div></div>
      <div class="door" id="d6" data-hinge="right"><div class="hinge"></div><div class="leaf"></div><div class="label">Ușa 6</div></div>
    </div>
  </div>
</div>

<script>
/* =======================
   1) CONFIG – MODIFICĂ AICI
   x, y = procente din overlay (0–100)
   a    = unghi (grade)
   hinge = 'left' | 'right'
======================= */
const CONFIG = {
  d1: { x:  110, y: 107, a: 180, hinge:'left'  },
  d2: { x:  2, y: 34, a:   0, hinge:'left'  },
  d3: { x:  2, y: 56, a:   0, hinge:'left'  },
  d4: { x: 92, y: 20, a: 180, hinge:'right' },
  d5: { x: 92, y: 45, a: 180, hinge:'right' },
  d6: { x: 92, y: 70, a: 180, hinge:'right' }
};
/* ======================= */

/* 2) Uși – stare vizuală */
const state = {}; // id -> 'LOCKED' | 'UNLOCKED' | 'NOPOWER'
function setDoorState(id, st){
  state[id] = st;
  const el = document.getElementById(id);
  if(!el) return;
  el.classList.toggle('open', st==='UNLOCKED');
  el.classList.toggle('nopower', st==='NOPOWER');
}
document.querySelectorAll('.door').forEach(el=>{
  state[el.id] = 'LOCKED';
  el.addEventListener('click', (e)=>{
    const id = el.id;
    if(e.shiftKey){ setDoorState(id,'NOPOWER'); return; }
    setDoorState(id, state[id]==='LOCKED' ? 'UNLOCKED' : 'LOCKED');
  });
});

/* 3) Aplică poziții din CONFIG (în procente) */
function applyConfig(){
  Object.keys(CONFIG).forEach(id=>{
    const el = document.getElementById(id);
    if(!el) return;
    const {x,y,a,hinge} = CONFIG[id];
    el.style.setProperty('--x', (x||0) + '%');
    el.style.setProperty('--y', (y||0) + '%');
    el.style.setProperty('--a', (a||0));
    if(hinge) el.dataset.hinge = hinge;
  });
}

/* 4) HUD coordonate mouse (în procente și px) – pentru „măsurare” */
const overlay = document.getElementById('overlay');
const hud = document.getElementById('hud');
const pxSpan = document.getElementById('px');

function updateHud(e){
  const rect = overlay.getBoundingClientRect();
  const xpx = Math.max(0, Math.min(rect.width,  e.clientX - rect.left));
  const ypx = Math.max(0, Math.min(rect.height, e.clientY - rect.top));
  const x = (xpx / rect.width ) * 100;
  const y = (ypx / rect.height) * 100;

  hud.innerHTML = `X: <code>${x.toFixed(1)}%</code> &nbsp; Y: <code>${y.toFixed(1)}%</code> &nbsp; `;
  pxSpan.textContent = `(${Math.round(xpx)}×${Math.round(ypx)} px)`;
  hud.appendChild(pxSpan);
}
overlay.addEventListener('mousemove', updateHud);

/* Click pe overlay => copiază în clipboard o linie de CONFIG cu coordonatele */
overlay.addEventListener('click', (e)=>{
  // nu declanșăm când ai dat click pe o ușă
  if (e.target.closest('.door')) return;

  const rect = overlay.getBoundingClientRect();
  const x = ((e.clientX - rect.left) / rect.width ) * 100;
  const y = ((e.clientY - rect.top ) / rect.height) * 100;
  const line = `{ x: ${x.toFixed(1)}, y: ${y.toFixed(1)}, a: 0, hinge:'left' }`;

  // copie în clipboard
  const txt = `// INSEREAZĂ ÎN CONFIG:\n${line}`;
  navigator.clipboard?.writeText(txt).then(()=>{
    hud.innerHTML = `✅ Copiat: <code>${line}</code>`;
    setTimeout(()=>{ hud.innerHTML = `X: <code>0%</code> &nbsp; Y: <code>0%</code> &nbsp; <span id="px">(0×0 px)</span>`; }, 1800);
  }).catch(()=>{
    alert(txt);
  });
});

/* Inițializează */
applyConfig();

/* ===== MQTT (opțional) =====
   - poți adăuga mqtt.min.js și să folosești setDoorState('d1','LOCKED'|'UNLOCKED'|'NOPOWER').
*/
</script>
</body>
</html>



